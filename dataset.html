<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>D3 Page Template</title>
    <link rel="stylesheet" href="index.css">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
</head>
<body>
<script type="text/javascript" src="data/congocountries.js"></script>
<script src="js/moment.min.js"></script>
<script type="text/javascript">



/*
    var rowConverter = function (d) {
        return {
            report_date: d.report_date, //No conversion
            province: d.province,
            health_zone: d.health_zone,
            confirmed_cases: d.confirmed_cases
        };
    };

    d3.json("data/csvjson.json", rowConverter, function (data) {
        d3.select("body").selectAll("p")
            .data(data)
            .enter()
            .append("p")
            .text(function (d) {
                if (d.confirmed_cases>100)
                    console.log(d.report_date+","+d.province+","+d.health_zone+"||"+d.confirmed_cases);

            })
    });
*/
let summe = 0;
sortData("North Kivu", "2019", "07");
function sortData(pro, year, month){

    d3.json("data/csvjson.json", function(json) {

        for (let i = 0; i < json.length; i++){
               // statesData.features[j].properties.confirmed_case = 0;
                if (json[i].confirmed_cases>500){
                    let d = new Date(json[i].report_date);
                    let dayWrapper = moment(d).format("DD");
                    let monthWrapper = moment(d).format("MM");
                    let yearWrapper = moment(d).format("YYYY");
                    let datum = moment(d).format("DD-MM-YYYY");
                    // console.log("Datum: " +dayWrapper + "-" + monthWrapper + "-" + yearWrapper + " == " + json[i].province)
                    if(json[i].province === pro && yearWrapper === year && monthWrapper === month){

                        summe += json[i].confirmed_cases;

                        //console.log(statesData.features[j].properties.confirmed_cases)

                      //  console.log(json[i].confirmed_cases + "==" + datum + " " + json[i].province);

                    }
                }
        }
        data(summe);
        console.log(summe)
    });
}


function data(test) {
    for (let j = 0; j < statesData.features.length; j++)
    {
        statesData.features[0].properties.confirmed_case = test;

    }
    console.log("BELIJAT: "+statesData.features[0].properties.confirmed_case);
}


</script>
</body>
</html>